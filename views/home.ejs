<link rel="stylesheet" href="/css/home.css" type="text/css" />

<% if (!locals.user){%>

<h1>Codeial Home page</h1>

<%}else{%>

<div class="home-feedwall" id="home-feedwall">
  <section id="feed-posts" class="feed-posts">
    <h3>Post your thoughts</h3>
    <form action="/posts/create" id="new-post-method" method="POST">
      <textarea
        name="content"
        id=""
        cols="30"
        rows="3"
        placeholder="Write here..."
      ></textarea>
      <button type="submit">POST</button>
    </form>
  </section>

  <section class="user-posts" id="user-posts">
    <ul>
      <%for (let i = posts.length-1; i >=0; i--) {%>
      <li>
        <div class="display-3"><%= posts[i].user.name%></div>
        <div class="display-5 timestamp"><%= posts[i].posted_time%></div>
        <p class="post-content"><%= posts[i].content %></p>
        <div class="comments-container">
          <ul>
            <% if(true){%>
            <li class="comment">
              <div>
                <h4>Hero</h4>
                <p class="comment-content">Lorem ipsum, dolor sit amet</p>
              </div>
              <p class="display-5">
                <span>Like</span><span>Comment</span><span>Date</span>
              </p>
            </li>

            <% }%>
          </ul>
        </div>

        <% if (locals.user){%>
        <form action="/comment/create %>" method="post">
          <div>
            <textarea
              name="content"
              placeholder="Write a comment..."
              cols="30"
              rows="1"
              id="comment-textarea"
            ></textarea>
            <input type="hidden" name="post" value="<%=posts[i]._id%>" />
            <div class="button-space">
              <button type="submit">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
          </div>
        </form>
        <%}%>
      </li>
      <%}%>
    </ul>
  </section>
</div>
<%}%>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="/js/home.js" type="text/javascript"></script>
