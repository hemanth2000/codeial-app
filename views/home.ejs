<link rel="stylesheet" href="/css/home.css" type="text/css" />

<% if (!locals.user){%>

<h1>Codeial Home page</h1>

<%}else{%>

<div class="home-feedwall" id="home-feedwall">
  <section id="feed-posts" class="feed-posts">
    <h3>Post your thoughts</h3>
    <form action="/posts/create" id="new-post-method" method="POST">
      <textarea
        name="content"
        id=""
        cols="30"
        rows="3"
        placeholder="Write here..."
      ></textarea>
      <button type="submit">POST</button>
    </form>
  </section>

  <section class="user-posts" id="user-posts">
    <ul class="posts-list">
      <%for (post of posts){%>
      <li class="post-card">
        <div class="display-3"><%= post.user.name%></div>
        <div class="display-5 timestamp"><%= post.posted_time%></div>
        <p class="post-content"><%= post.content %></p>

        <% if (locals.user){%>
        <form action="/comment/create %>" method="post">
          <div>
            <textarea
              name="content"
              placeholder="Write a comment..."
              cols="30"
              rows="1"
              id="comment-textarea"
            ></textarea>
            <input type="hidden" name="post" value="<%=post._id%>" />
            <div class="button-space">
              <button type="submit">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
          </div>
        </form>
        <%}%>

        <div class="comments-container">
          <ul class="comments-list">
            <% for (comment of post.comments){%>
            <li class="comment" id="comment">
              <div>
                <span><%= comment.user.name%></span>
                <p class="comment-content"><%= comment.content%></p>
              </div>
              <p class="display-5">
                <span>Like</span><span>Comment</span><span>Date</span>
              </p>
            </li>
            <% }%>
          </ul>
        </div>
      </li>
      <%}%>
    </ul>
  </section>
</div>
<%}%>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="/js/home.js" type="text/javascript"></script>
